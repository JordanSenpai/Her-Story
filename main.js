for (var i = 0; i < 3000; i++) {
    $('div#tileset').append("<div style='width: 30px; height: 30px; border: 1px solid red; float: left; font-size: 11px; text-shadow: 1px 1px 1px white;'>" + i + "</div>");
}
$('.btnTileset').click(function() {
    $('#tileset').toggle(500);
});


////////////////////////////////////////// map layout ////////////////////////////////////////////////
var map = {
    'width': 1840,
    'height': 1080,
    'slotSize': 32,
    'bg': 'white',
    'tileset': 'http://fc03.deviantart.net/fs26/i/2008/149/d/7/rpg_maker_xp_the_best_tileset_by_davide_86.png',
    'colision': [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], //1
        [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], //2
        [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], //3
        [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], //4
        [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], //5
        [0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0], //6
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0], //7
        [0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0], //8
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //9
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //10
        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //11
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //12
        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //13
        [1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //14
        [1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //15
        [1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //16
        [1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //17
        [1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //18
        [1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0], //19
        [1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //20
        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //21    
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //22
        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //23
        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //24
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //25
        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], //26
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //27
        [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0] //28
    ],
    'firstPlan': [
        [348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348], //1
        [348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348], //2
        [348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348], //3
        [348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348], //4
        [348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348], //5
        [348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348], //6
        [348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348, 348], //7
        [348, 348, 348, 348, 348, 348, 348, 348, 2136, 2137, 2137, 2138, 348, 348, 348, 348, 348, 348, 348, 348], //8
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //9
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //10
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //11
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //12
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //13
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //14
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //15
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //16
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //17
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //18
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //19
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //20  
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //21
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //22
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //23
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //24
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //25
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //26
        [348, 348, 348, 348, 348, 348, 348, 348, 2144, 2145, 2145, 2146, 348, 348, 348, 348, 348, 348, 348, 348], //27
        [348, 348, 348, 348, 348, 348, 348, 348, 2152, 2153, 2153, 2154, 348, 348, 348, 348, 348, 348, 348, 348] //28
        ],
    'secondPlan': [
        [2680, 0, 2683, 0, 2680, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2682, 0, 2680, 0, 2683], //1
        [2688, 0, 2691, 0, 2689, 0, 158, 0, 0, 0, 158, 0, 0, 0, 0, 2690, 0, 2689, 0, 2691], //2
        [0, 2682, 0, 2680, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2683, 0, 2680, 0], //3
        [0, 2690, 0, 2688, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2691, 0, 2688, 0], //4
        [2680, 0, 2682, 0, 2683, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2680, 0, 1232, 0, 2682], //5
        [2688, 0, 2690, 0, 2691, 0, 1568, 1569, 0, 1233, 1233, 0, 1570, 1571, 0, 2689, 0, 2688, 0, 2690], //6
        [0, 0, 0, 0, 0, 0, 1576, 1577, 0, 1241, 1241, 0, 1578, 1579, 0, 0, 0, 0, 0, 0], //7
        [0, 0, 0, 0, 0, 0, 1584, 1585, 0, 0,0, 0, 1586, 1587, 0, 0, 0, 0, 0, 0], //8
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //9
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //10
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //11
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //12
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //13
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //14
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //15
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //16
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 382, 383, 0, 0, 0, 0], //17
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 362, 0, 0], //18
        [0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //19
        [1174, 1175, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 355, 0, 0, 351, 0, 0],  //20 
        [1182, 1183, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //21
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //22    
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //23
        [0, 353, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 357, 0, 0, 0], //24
        [0, 0, 0, 0, 349, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //25
        [0, 0, 0, 357, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 354, 0, 0, 0, 0, 0], //26
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 364], //27
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 366, 367, 0, 372,] //28
        ],
    'thirdPlan': [
        [0, 0, 0, 0, 0, 0, 296, 297, 298, 299, 300, 301, 302, 303, 0, 0, 0, 0, 0, 0], //1
        [0, 0, 0, 0, 0, 0, 304, 305, 306, 307, 308, 309, 310, 311, 0, 0, 0, 0, 0, 0], //2
        [0, 0, 0, 0, 0, 0, 312, 313, 314, 315, 316, 317, 318, 319, 0, 0, 0, 0, 0, 0], //3
        [0, 0, 0, 0, 0, 0, 320, 321, 322, 323, 324, 325, 326, 327, 0, 0, 0, 0, 0, 0], //4
        [0, 0, 0, 0, 0, 0, 328, 329, 330, 331, 332, 333, 334, 335, 0, 0, 0, 0, 0, 0], //5
        [0, 0, 0, 0, 0, 0, 336, 337, 338, 339, 340, 341, 342, 343, 0, 0, 0, 0, 0, 0], //6
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //7
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //8
        [0, 0, 0, 0, 0, 0, 0, 2607, 0, 0, 0, 0, 2607, 0, 0, 0, 0, 0, 0, 0], //9
        [0, 0, 0, 0, 0, 0, 0, 2615, 0, 0, 0, 0, 2615, 0, 0, 0, 0, 0, 0, 0], //10
        [0, 0, 0, 0, 0, 0, 0, 1796, 0, 0, 0, 0, 1796, 0, 0, 0, 0, 0, 0, 0], //11
        [1304, 1305, 1306, 1307, 1308, 0, 0, 1804, 0, 0, 0, 0, 1804, 0, 0, 0, 0, 0, 0, 0], //12
        [1312, 1313, 1314, 1315, 1316, 0, 0, 1812, 0, 0, 0, 0, 1812, 0, 0, 0, 0, 0, 0, 0], //13
        [1320, 1321, 1322, 1323, 1324, 0, 0, 2607, 0, 0, 0, 0, 2607, 0, 0, 0, 0, 0, 0, 0], //14
        [1328, 1329, 1330, 1331, 1332, 0, 0, 2615, 0, 0, 0, 0, 2615, 0, 0, 0, 0, 0, 0, 0], //15
        [1336, 1337, 1338, 1339, 1340, 0, 0, 1796, 0, 0, 0, 0, 1796, 0, 0, 0, 0, 0, 0, 0], //16
        [1344, 1345, 1346, 1347, 1348, 0, 0, 1804, 0, 0, 0, 0, 1804, 0, 0, 0, 0, 0, 0, 0], //17
        [1352, 1353, 1354, 1355, 1356, 0, 0, 1812, 0, 0, 0, 0, 1812, 0, 0, 0, 0, 0, 0, 0], //18
        [1360, 1361, 1362, 1363, 1364, 0, 0, 2607, 0, 0, 0, 0, 2607, 0, 0, 0, 0, 0, 0, 0], //19
        [0, 0, 0, 0, 0, 0, 0, 2615, 0, 0, 0, 0, 2615, 0, 0, 0, 0, 0, 0, 0],  //20
        [0, 0, 0, 0, 0, 0, 0, 1796, 0, 0, 0, 0, 1796, 0, 376, 377, 378, 379, 380, 381], //21
        [0, 0, 0, 0, 0, 0, 0, 1804, 0, 0, 0, 0, 1804, 0, 384, 385, 386, 387, 388, 389], //22    
        [0, 0, 0, 0, 0, 0, 0, 1812, 0, 0, 0, 0, 1812, 0, 392, 393, 394, 395, 396, 397], //23
        [0, 0, 0, 0, 0, 0, 0, 2607, 0, 0, 0, 0, 2607, 0, 400, 401, 402, 403, 404, 405], //24
        [0, 0, 0, 0, 0, 0, 0, 2615, 0, 0, 0, 0, 2615, 0, 408, 409, 410, 411, 412, 413], //25
        [0, 0, 0, 0, 0, 0, 0, 1796, 0, 0, 0, 0, 1796, 0, 0, 0, 0, 0, 0, 0], //26
        [0, 0, 0, 0, 0, 0, 0, 1804, 0, 0, 0, 0, 1804, 0, 0, 0, 0, 0, 0, 0], //27
        [0, 0, 0, 0, 0, 0, 0, 1812, 0, 0, 0, 0, 1812, 0, 0, 0, 0, 0, 0, 0] //28
        ],
        'fourthPlan': [
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //1
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //2
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //3
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //4
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //5
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //6
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //7
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //8
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //9
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //10
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //11
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //12
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //13
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //14
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //15
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //16
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //17
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //18
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //19
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //20 
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //21    
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //22
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //23
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //24
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //25
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //26
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], //27
            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] //28
            ]
};

$('.map').css({
    'width': map.width,
    'height': map.height,
    'background': map.bg
});

function planMaker(selector) {
    for ($i = 0; $i < map.colision.length; $i++) {
        for ($j = 0; $j < map.colision[0].length; $j++) {
            if (selector === ".first-plan") {
                var bg = map.firstPlan[$i][$j];
            } else if (selector === ".second-plan") {
                var bg = map.secondPlan[$i][$j];
            } else if (selector === ".third-plan") {
                var bg = map.thirdPlan[$i][$j];
            } else if (selector === ".fourth-plan") {
                var bg = map.thirdPlan[$i][$j];
            }

            if (bg != 0) {
                $bgy = bg > 8 ? Math.floor((bg / 8)) * map.slotSize : 0;
                $bgx = bg > 8 ? (bg % 8) * map.slotSize : bg * map.slotSize;
                $(selector).append("<div style='width: 32px; height: 32px; float: left; background: url(" + map.tileset + ")" + (-$bgx + "px" + " " + -$bgy + "px") + ";' name='" + $i + $j + " '></div>");
            } else {
                $(selector).append("<div style='width: 32px; height: 32px; float: left;'></div>");
            }
        }
    }
}
planMaker(".first-plan");
planMaker(".second-plan");
planMaker(".third-plan");
planMaker(".fourth-plan");

////////////////////////////////////////////////////// main character Sprite //////////////////////////
var char = {
    'id': '*',
    'width': 32,
    'height': 32,
    'step': 32,
    'bg': 'assets/knightSprite.png',
    'speed': 300,
    'position': [27, 10]
};
$positionY = char.position[0];
$positionX = char.position[1];
$char = $('.char');

$char.css({
    'width': char.width,
    'height': char.height,
    'position': 'absolute',
    'left': char.step * $positionX,
    'top': char.step * $positionY,
    'marginTop': -char.height + (map.slotSize / 2),
    'backgroundImage': 'url(' + char.bg + ')'
});


function charPosition() {
    for ($i = 0; $i < map.colision.length; $i++) {
        for ($j = 0; $j < map.colision[0].length; $j++) {
            if (map.colision[$i][$j] == '*') {
                $('.char-position').html("[ Y: " + $i + " ]" + "[ X: " + $j + " ]");
            }
        }
    }
}


function charSprite(spriteY) {
    $char.css({
        'backgroundPosition': '-99px ' + spriteY,
    });

    setTimeout(function() {
        $char.css({
            'backgroundPosition': '-66px ' + spriteY,
        });
    }, 50);
    setTimeout(function() {
        $char.css({
            'backgroundPosition': '-33px ' + spriteY,
        });
    }, 100);
    setTimeout(function() {
        $char.css({
            'backgroundPosition': '-0px ' + spriteY,
        });
    }, 150);

}
/////////////////////////////////// movement of main character ////////////////////////////////////

$('body').keydown(function(e) {
    e.preventDefault();
    var $key = e.which;
    if ($key == 39 && ($char.is(':animated') === false)) {
        if (map.colision[$positionY][$positionX + 1] === 0) {
            map.colision[$positionY][$positionX] = 0;
            $positionX = ++$positionX;
            map.colision[$positionY][$positionX] = char.id;

///////////////////////////////////////////// right ///////////////////////////////////////////////
            
            $char.animate({
                'marginLeft': '-=' + -char.step,
            }, char.speed);
            charSprite('-66px');
            charPosition();
        }
    }
    else if ($key == 37 && ($char.is(':animated') === false)) {
        if (map.colision[$positionY][$positionX - 1] === 0) {
            map.colision[$positionY][$positionX] = 0;
            $positionX = --$positionX;
            map.colision[$positionY][$positionX] = char.id;

/////////////////////////////////////////////// left ///////////////////////////////////////////////
            
            $char.animate({
                'marginLeft': '+=' + -char.step,
            }, char.speed);

            charSprite('-33px');
            charPosition();
        }
    }
    else if ($key == 38 && ($char.is(':animated') === false)) {
        if (map.colision[$positionY - 1][$positionX] === 0) {
            map.colision[$positionY][$positionX] = 0;
            $positionY = --$positionY;
            map.colision[$positionY][$positionX] = char.id;

////////////////////////////////////////////////// Up //////////////////////////////////////////////
           
            $char.animate({
                'marginTop': '+=' + -char.step,
            }, char.speed);
            charSprite('-99px');
            charPosition();
        }
    }
    else if ($key == 40 && ($char.is(':animated') === false)) {
        if (map.colision[$positionY + 1][$positionX] === 0) {
            map.colision[$positionY][$positionX] = 0;
            $positionY = ++$positionY;
            map.colision[$positionY][$positionX] = char.id;

////////////////////////////////////////////////// Down ////////////////////////////////////////////
            
            $char.animate({
                'marginTop': '-=' + -char.step,
            }, char.speed);
            charSprite('0px');
            charPosition();
        }
    }

});